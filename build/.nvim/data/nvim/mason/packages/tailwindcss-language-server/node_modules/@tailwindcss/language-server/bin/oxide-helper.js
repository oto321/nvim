#!/usr/bin/env node
var us=Object.create;var Fr=Object.defineProperty;var ls=Object.getOwnPropertyDescriptor;var ds=Object.getOwnPropertyNames;var fs=Object.getPrototypeOf,hs=Object.prototype.hasOwnProperty;var N=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var ps=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ds(e))!hs.call(r,i)&&i!==t&&Fr(r,i,{get:()=>e[i],enumerable:!(n=ls(e,i))||n.enumerable});return r};var lt=(r,e,t)=>(t=r!=null?us(fs(r)):{},ps(e||!r||!r.__esModule?Fr(t,"default",{value:r,enumerable:!0}):t,r));var ge=N(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.stringArray=j.array=j.func=j.error=j.number=j.string=j.boolean=void 0;function ms(r){return r===!0||r===!1}j.boolean=ms;function Gr(r){return typeof r=="string"||r instanceof String}j.string=Gr;function gs(r){return typeof r=="number"||r instanceof Number}j.number=gs;function Es(r){return r instanceof Error}j.error=Es;function bs(r){return typeof r=="function"}j.func=bs;function Ur(r){return Array.isArray(r)}j.array=Ur;function ys(r){return Ur(r)&&r.every(e=>Gr(e))}j.stringArray=ys});var kt=N(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.Message=h.NotificationType9=h.NotificationType8=h.NotificationType7=h.NotificationType6=h.NotificationType5=h.NotificationType4=h.NotificationType3=h.NotificationType2=h.NotificationType1=h.NotificationType0=h.NotificationType=h.RequestType9=h.RequestType8=h.RequestType7=h.RequestType6=h.RequestType5=h.RequestType4=h.RequestType3=h.RequestType2=h.RequestType1=h.RequestType=h.RequestType0=h.AbstractMessageSignature=h.ParameterStructures=h.ResponseError=h.ErrorCodes=void 0;var ue=ge(),dt;(function(r){r.ParseError=-32700,r.InvalidRequest=-32600,r.MethodNotFound=-32601,r.InvalidParams=-32602,r.InternalError=-32603,r.jsonrpcReservedErrorRangeStart=-32099,r.serverErrorStart=-32099,r.MessageWriteError=-32099,r.MessageReadError=-32098,r.PendingResponseRejected=-32097,r.ConnectionInactive=-32096,r.ServerNotInitialized=-32002,r.UnknownErrorCode=-32001,r.jsonrpcReservedErrorRangeEnd=-32e3,r.serverErrorEnd=-32e3})(dt||(h.ErrorCodes=dt={}));var ft=class r extends Error{constructor(e,t,n){super(t),this.code=ue.number(e)?e:dt.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,r.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};h.ResponseError=ft;var G=class r{constructor(e){this.kind=e}static is(e){return e===r.auto||e===r.byName||e===r.byPosition}toString(){return this.kind}};h.ParameterStructures=G;G.auto=new G("auto");G.byPosition=new G("byPosition");G.byName=new G("byName");var v=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return G.auto}};h.AbstractMessageSignature=v;var ht=class extends v{constructor(e){super(e,0)}};h.RequestType0=ht;var pt=class extends v{constructor(e,t=G.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};h.RequestType=pt;var mt=class extends v{constructor(e,t=G.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};h.RequestType1=mt;var gt=class extends v{constructor(e){super(e,2)}};h.RequestType2=gt;var Et=class extends v{constructor(e){super(e,3)}};h.RequestType3=Et;var bt=class extends v{constructor(e){super(e,4)}};h.RequestType4=bt;var yt=class extends v{constructor(e){super(e,5)}};h.RequestType5=yt;var Rt=class extends v{constructor(e){super(e,6)}};h.RequestType6=Rt;var St=class extends v{constructor(e){super(e,7)}};h.RequestType7=St;var _t=class extends v{constructor(e){super(e,8)}};h.RequestType8=_t;var Nt=class extends v{constructor(e){super(e,9)}};h.RequestType9=Nt;var Tt=class extends v{constructor(e,t=G.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};h.NotificationType=Tt;var wt=class extends v{constructor(e){super(e,0)}};h.NotificationType0=wt;var Ot=class extends v{constructor(e,t=G.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};h.NotificationType1=Ot;var vt=class extends v{constructor(e){super(e,2)}};h.NotificationType2=vt;var Pt=class extends v{constructor(e){super(e,3)}};h.NotificationType3=Pt;var It=class extends v{constructor(e){super(e,4)}};h.NotificationType4=It;var Lt=class extends v{constructor(e){super(e,5)}};h.NotificationType5=Lt;var Ct=class extends v{constructor(e){super(e,6)}};h.NotificationType6=Ct;var Mt=class extends v{constructor(e){super(e,7)}};h.NotificationType7=Mt;var $t=class extends v{constructor(e){super(e,8)}};h.NotificationType8=$t;var At=class extends v{constructor(e){super(e,9)}};h.NotificationType9=At;var Vr;(function(r){function e(i){let u=i;return u&&ue.string(u.method)&&(ue.string(u.id)||ue.number(u.id))}r.isRequest=e;function t(i){let u=i;return u&&ue.string(u.method)&&i.id===void 0}r.isNotification=t;function n(i){let u=i;return u&&(u.result!==void 0||!!u.error)&&(ue.string(u.id)||ue.number(u.id)||u.id===null)}r.isResponse=n})(Vr||(h.Message=Vr={}))});var jt=N(ee=>{"use strict";var Xr;Object.defineProperty(ee,"__esModule",{value:!0});ee.LRUCache=ee.LinkedMap=ee.Touch=void 0;var D;(function(r){r.None=0,r.First=1,r.AsOld=r.First,r.Last=2,r.AsNew=r.Last})(D||(ee.Touch=D={}));var xe=class{constructor(){this[Xr]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=D.None){let n=this._map.get(e);if(n)return t!==D.None&&this.touch(n,t),n.value}set(e,t,n=D.None){let i=this._map.get(e);if(i)i.value=t,n!==D.None&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case D.None:this.addItemLast(i);break;case D.First:this.addItemFirst(i);break;case D.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return n}values(){let e=this._state,t=this._head,n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return n}entries(){let e=this._state,t=this._head,n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return n}[(Xr=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==D.First&&t!==D.Last)){if(t===D.First){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===D.Last){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}};ee.LinkedMap=xe;var xt=class extends xe{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=D.AsNew){return super.get(e,t)}peek(e){return super.get(e,D.None)}set(e,t){return super.set(e,t,D.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};ee.LRUCache=xt});var Br=N(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.Disposable=void 0;var Wr;(function(r){function e(t){return{dispose:t}}r.create=e})(Wr||(je.Disposable=Wr={}))});var te=N(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});var Dt;function qt(){if(Dt===void 0)throw new Error("No runtime abstraction layer installed");return Dt}(function(r){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");Dt=t}r.install=e})(qt||(qt={}));Ft.default=qt});var be=N(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.Emitter=Ee.Event=void 0;var Rs=te(),zr;(function(r){let e={dispose(){}};r.None=function(){return e}})(zr||(Ee.Event=zr={}));var Gt=class{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let i=0,u=this._callbacks.length;i<u;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else n=!0;if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],n=this._callbacks.slice(0),i=this._contexts.slice(0);for(let u=0,S=n.length;u<S;u++)try{t.push(n[u].apply(i[u],e))}catch(L){(0,Rs.default)().console.error(L)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},De=class r{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{this._callbacks||(this._callbacks=new Gt),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=r._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};Ee.Emitter=De;De._noop=function(){}});var Ge=N(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.CancellationTokenSource=ye.CancellationToken=void 0;var Ss=te(),_s=ge(),Ut=be(),qe;(function(r){r.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Ut.Event.None}),r.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Ut.Event.None});function e(t){let n=t;return n&&(n===r.None||n===r.Cancelled||_s.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}r.is=e})(qe||(ye.CancellationToken=qe={}));var Ns=Object.freeze(function(r,e){let t=(0,Ss.default)().timer.setTimeout(r.bind(e),0);return{dispose(){t.dispose()}}}),Fe=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Ns:(this._emitter||(this._emitter=new Ut.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},Vt=class{get token(){return this._token||(this._token=new Fe),this._token}cancel(){this._token?this._token.cancel():this._token=qe.Cancelled}dispose(){this._token?this._token instanceof Fe&&this._token.dispose():this._token=qe.None}};ye.CancellationTokenSource=Vt});var Hr=N(Re=>{"use strict";Object.defineProperty(Re,"__esModule",{value:!0});Re.SharedArrayReceiverStrategy=Re.SharedArraySenderStrategy=void 0;var Ts=Ge(),ve;(function(r){r.Continue=0,r.Cancelled=1})(ve||(ve={}));var Xt=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let t=new SharedArrayBuffer(4),n=new Int32Array(t,0,1);n[0]=ve.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){let n=this.buffers.get(t);if(n===void 0)return;let i=new Int32Array(n,0,1);Atomics.store(i,0,ve.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};Re.SharedArraySenderStrategy=Xt;var Wt=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===ve.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},Bt=class{constructor(e){this.token=new Wt(e)}cancel(){}dispose(){}},zt=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let t=e.$cancellationData;return t===void 0?new Ts.CancellationTokenSource:new Bt(t)}};Re.SharedArrayReceiverStrategy=zt});var Jt=N(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.Semaphore=void 0;var ws=te(),Ht=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,ws.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(n=>{this._active--,e.resolve(n),this.runNext()},n=>{this._active--,e.reject(n),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};Ue.Semaphore=Ht});var Qr=N(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.ReadableStreamMessageReader=re.AbstractMessageReader=re.MessageReader=void 0;var Kt=te(),Se=ge(),Qt=be(),Os=Jt(),Jr;(function(r){function e(t){let n=t;return n&&Se.func(n.listen)&&Se.func(n.dispose)&&Se.func(n.onError)&&Se.func(n.onClose)&&Se.func(n.onPartialMessage)}r.is=e})(Jr||(re.MessageReader=Jr={}));var Ve=class{constructor(){this.errorEmitter=new Qt.Emitter,this.closeEmitter=new Qt.Emitter,this.partialMessageEmitter=new Qt.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${Se.string(e.message)?e.message:"unknown"}`)}};re.AbstractMessageReader=Ve;var Yt;(function(r){function e(t){let n,i,u,S=new Map,L,F=new Map;if(t===void 0||typeof t=="string")n=t??"utf-8";else{if(n=t.charset??"utf-8",t.contentDecoder!==void 0&&(u=t.contentDecoder,S.set(u.name,u)),t.contentDecoders!==void 0)for(let $ of t.contentDecoders)S.set($.name,$);if(t.contentTypeDecoder!==void 0&&(L=t.contentTypeDecoder,F.set(L.name,L)),t.contentTypeDecoders!==void 0)for(let $ of t.contentTypeDecoders)F.set($.name,$)}return L===void 0&&(L=(0,Kt.default)().applicationJson.decoder,F.set(L.name,L)),{charset:n,contentDecoder:u,contentDecoders:S,contentTypeDecoder:L,contentTypeDecoders:F}}r.fromOptions=e})(Yt||(Yt={}));var Zt=class extends Ve{constructor(e,t){super(),this.readable=e,this.options=Yt.fromOptions(t),this.buffer=(0,Kt.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new Os.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(n=>{this.onData(n)});return this.readable.onError(n=>this.fireError(n)),this.readable.onClose(()=>this.fireClose()),t}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let n=this.buffer.tryReadHeaders(!0);if(!n)return;let i=n.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(n))}`));return}let u=parseInt(i);if(isNaN(u)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=u}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let n=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,i=await this.options.contentTypeDecoder.decode(n,this.options);this.callback(i)}).catch(n=>{this.fireError(n)})}}catch(t){this.fireError(t)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,Kt.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};re.ReadableStreamMessageReader=Zt});var tn=N(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.WriteableStreamMessageWriter=ne.AbstractMessageWriter=ne.MessageWriter=void 0;var Kr=te(),Pe=ge(),vs=Jt(),Yr=be(),Ps="Content-Length: ",Zr=`\r
`,en;(function(r){function e(t){let n=t;return n&&Pe.func(n.dispose)&&Pe.func(n.onClose)&&Pe.func(n.onError)&&Pe.func(n.write)}r.is=e})(en||(ne.MessageWriter=en={}));var Xe=class{constructor(){this.errorEmitter=new Yr.Emitter,this.closeEmitter=new Yr.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${Pe.string(e.message)?e.message:"unknown"}`)}};ne.AbstractMessageWriter=Xe;var er;(function(r){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,Kr.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,Kr.default)().applicationJson.encoder}}r.fromOptions=e})(er||(er={}));var tr=class extends Xe{constructor(e,t){super(),this.writable=e,this.options=er.fromOptions(t),this.errorCount=0,this.writeSemaphore=new vs.Semaphore(1),this.writable.onError(n=>this.fireError(n)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(n=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(n):n).then(n=>{let i=[];return i.push(Ps,n.byteLength.toString(),Zr),i.push(Zr),this.doWrite(e,i,n)},n=>{throw this.fireError(n),n}))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};ne.WriteableStreamMessageWriter=tr});var rn=N(We=>{"use strict";Object.defineProperty(We,"__esModule",{value:!0});We.AbstractMessageBuffer=void 0;var Is=13,Ls=10,Cs=`\r
`,rr=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,n=0,i=0,u=0;e:for(;n<this._chunks.length;){let $=this._chunks[n];for(i=0;i<$.length;){switch($[i]){case Is:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case Ls:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}u+=$.byteLength,n++}if(t!==4)return;let S=this._read(u+i),L=new Map,F=this.toString(S,"ascii").split(Cs);if(F.length<2)return L;for(let $=0;$<F.length-2;$++){let W=F[$],H=W.indexOf(":");if(H===-1)throw new Error(`Message header must separate key and value using ':'
${W}`);let ie=W.substr(0,H),fe=W.substr(H+1).trim();L.set(e?ie.toLowerCase():ie,fe)}return L}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let u=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(u)}if(this._chunks[0].byteLength>e){let u=this._chunks[0],S=this.asNative(u,e);return this._chunks[0]=u.slice(e),this._totalLength-=e,S}let t=this.allocNative(e),n=0,i=0;for(;e>0;){let u=this._chunks[i];if(u.byteLength>e){let S=u.slice(0,e);t.set(S,n),n+=e,this._chunks[i]=u.slice(e),this._totalLength-=e,e-=e}else t.set(u,n),n+=u.byteLength,this._chunks.shift(),this._totalLength-=u.byteLength,e-=u.byteLength}return t}};We.AbstractMessageBuffer=rr});var cn=N(m=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.createMessageConnection=m.ConnectionOptions=m.MessageStrategy=m.CancellationStrategy=m.CancellationSenderStrategy=m.CancellationReceiverStrategy=m.RequestCancellationReceiverStrategy=m.IdCancellationReceiverStrategy=m.ConnectionStrategy=m.ConnectionError=m.ConnectionErrors=m.LogTraceNotification=m.SetTraceNotification=m.TraceFormat=m.TraceValues=m.Trace=m.NullLogger=m.ProgressType=m.ProgressToken=void 0;var nn=te(),I=ge(),p=kt(),sn=jt(),Ie=be(),nr=Ge(),Me;(function(r){r.type=new p.NotificationType("$/cancelRequest")})(Me||(Me={}));var sr;(function(r){function e(t){return typeof t=="string"||typeof t=="number"}r.is=e})(sr||(m.ProgressToken=sr={}));var Le;(function(r){r.type=new p.NotificationType("$/progress")})(Le||(Le={}));var ir=class{constructor(){}};m.ProgressType=ir;var or;(function(r){function e(t){return I.func(t)}r.is=e})(or||(or={}));m.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var y;(function(r){r[r.Off=0]="Off",r[r.Messages=1]="Messages",r[r.Compact=2]="Compact",r[r.Verbose=3]="Verbose"})(y||(m.Trace=y={}));var on;(function(r){r.Off="off",r.Messages="messages",r.Compact="compact",r.Verbose="verbose"})(on||(m.TraceValues=on={}));(function(r){function e(n){if(!I.string(n))return r.Off;switch(n=n.toLowerCase(),n){case"off":return r.Off;case"messages":return r.Messages;case"compact":return r.Compact;case"verbose":return r.Verbose;default:return r.Off}}r.fromString=e;function t(n){switch(n){case r.Off:return"off";case r.Messages:return"messages";case r.Compact:return"compact";case r.Verbose:return"verbose";default:return"off"}}r.toString=t})(y||(m.Trace=y={}));var U;(function(r){r.Text="text",r.JSON="json"})(U||(m.TraceFormat=U={}));(function(r){function e(t){return I.string(t)?(t=t.toLowerCase(),t==="json"?r.JSON:r.Text):r.Text}r.fromString=e})(U||(m.TraceFormat=U={}));var ar;(function(r){r.type=new p.NotificationType("$/setTrace")})(ar||(m.SetTraceNotification=ar={}));var Be;(function(r){r.type=new p.NotificationType("$/logTrace")})(Be||(m.LogTraceNotification=Be={}));var Ce;(function(r){r[r.Closed=1]="Closed",r[r.Disposed=2]="Disposed",r[r.AlreadyListening=3]="AlreadyListening"})(Ce||(m.ConnectionErrors=Ce={}));var _e=class r extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,r.prototype)}};m.ConnectionError=_e;var cr;(function(r){function e(t){let n=t;return n&&I.func(n.cancelUndispatched)}r.is=e})(cr||(m.ConnectionStrategy=cr={}));var ze;(function(r){function e(t){let n=t;return n&&(n.kind===void 0||n.kind==="id")&&I.func(n.createCancellationTokenSource)&&(n.dispose===void 0||I.func(n.dispose))}r.is=e})(ze||(m.IdCancellationReceiverStrategy=ze={}));var ur;(function(r){function e(t){let n=t;return n&&n.kind==="request"&&I.func(n.createCancellationTokenSource)&&(n.dispose===void 0||I.func(n.dispose))}r.is=e})(ur||(m.RequestCancellationReceiverStrategy=ur={}));var He;(function(r){r.Message=Object.freeze({createCancellationTokenSource(t){return new nr.CancellationTokenSource}});function e(t){return ze.is(t)||ur.is(t)}r.is=e})(He||(m.CancellationReceiverStrategy=He={}));var Je;(function(r){r.Message=Object.freeze({sendCancellation(t,n){return t.sendNotification(Me.type,{id:n})},cleanup(t){}});function e(t){let n=t;return n&&I.func(n.sendCancellation)&&I.func(n.cleanup)}r.is=e})(Je||(m.CancellationSenderStrategy=Je={}));var Qe;(function(r){r.Message=Object.freeze({receiver:He.Message,sender:Je.Message});function e(t){let n=t;return n&&He.is(n.receiver)&&Je.is(n.sender)}r.is=e})(Qe||(m.CancellationStrategy=Qe={}));var Ke;(function(r){function e(t){let n=t;return n&&I.func(n.handleMessage)}r.is=e})(Ke||(m.MessageStrategy=Ke={}));var an;(function(r){function e(t){let n=t;return n&&(Qe.is(n.cancellationStrategy)||cr.is(n.connectionStrategy)||Ke.is(n.messageStrategy))}r.is=e})(an||(m.ConnectionOptions=an={}));var X;(function(r){r[r.New=1]="New",r[r.Listening=2]="Listening",r[r.Closed=3]="Closed",r[r.Disposed=4]="Disposed"})(X||(X={}));function Ms(r,e,t,n){let i=t!==void 0?t:m.NullLogger,u=0,S=0,L=0,F="2.0",$,W=new Map,H,ie=new Map,fe=new Map,ot,oe=new sn.LinkedMap,ae=new Map,Ae=new Set,J=new Map,w=y.Off,ce=U.Text,A,K=X.New,at=new Ie.Emitter,vr=new Ie.Emitter,Pr=new Ie.Emitter,Ir=new Ie.Emitter,Lr=new Ie.Emitter,Y=n&&n.cancellationStrategy?n.cancellationStrategy:Qe.Message;function Cr(s){if(s===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+s.toString()}function Xn(s){return s===null?"res-unknown-"+(++L).toString():"res-"+s.toString()}function Wn(){return"not-"+(++S).toString()}function Bn(s,a){p.Message.isRequest(a)?s.set(Cr(a.id),a):p.Message.isResponse(a)?s.set(Xn(a.id),a):s.set(Wn(),a)}function zn(s){}function Mr(){return K===X.Listening}function $r(){return K===X.Closed}function he(){return K===X.Disposed}function Ar(){(K===X.New||K===X.Listening)&&(K=X.Closed,vr.fire(void 0))}function Hn(s){at.fire([s,void 0,void 0])}function Jn(s){at.fire(s)}r.onClose(Ar),r.onError(Hn),e.onClose(Ar),e.onError(Jn);function kr(){ot||oe.size===0||(ot=(0,nn.default)().timer.setImmediate(()=>{ot=void 0,Qn()}))}function xr(s){p.Message.isRequest(s)?Yn(s):p.Message.isNotification(s)?es(s):p.Message.isResponse(s)?Zn(s):ts(s)}function Qn(){if(oe.size===0)return;let s=oe.shift();try{let a=n?.messageStrategy;Ke.is(a)?a.handleMessage(s,xr):xr(s)}finally{kr()}}let Kn=s=>{try{if(p.Message.isNotification(s)&&s.method===Me.type.method){let a=s.params.id,c=Cr(a),f=oe.get(c);if(p.Message.isRequest(f)){let _=n?.connectionStrategy,C=_&&_.cancelUndispatched?_.cancelUndispatched(f,zn):void 0;if(C&&(C.error!==void 0||C.result!==void 0)){oe.delete(c),J.delete(a),C.id=f.id,ke(C,s.method,Date.now()),e.write(C).catch(()=>i.error("Sending response for canceled message failed."));return}}let O=J.get(a);if(O!==void 0){O.cancel(),ct(s);return}else Ae.add(a)}Bn(oe,s)}finally{kr()}};function Yn(s){if(he())return;function a(b,P,R){let k={jsonrpc:F,id:s.id};b instanceof p.ResponseError?k.error=b.toJson():k.result=b===void 0?null:b,ke(k,P,R),e.write(k).catch(()=>i.error("Sending response failed."))}function c(b,P,R){let k={jsonrpc:F,id:s.id,error:b.toJson()};ke(k,P,R),e.write(k).catch(()=>i.error("Sending response failed."))}function f(b,P,R){b===void 0&&(b=null);let k={jsonrpc:F,id:s.id,result:b};ke(k,P,R),e.write(k).catch(()=>i.error("Sending response failed."))}ss(s);let O=W.get(s.method),_,C;O&&(_=O.type,C=O.handler);let M=Date.now();if(C||$){let b=s.id??String(Date.now()),P=ze.is(Y.receiver)?Y.receiver.createCancellationTokenSource(b):Y.receiver.createCancellationTokenSource(s);s.id!==null&&Ae.has(s.id)&&P.cancel(),s.id!==null&&J.set(b,P);try{let R;if(C)if(s.params===void 0){if(_!==void 0&&_.numberOfParams!==0){c(new p.ResponseError(p.ErrorCodes.InvalidParams,`Request ${s.method} defines ${_.numberOfParams} params but received none.`),s.method,M);return}R=C(P.token)}else if(Array.isArray(s.params)){if(_!==void 0&&_.parameterStructures===p.ParameterStructures.byName){c(new p.ResponseError(p.ErrorCodes.InvalidParams,`Request ${s.method} defines parameters by name but received parameters by position`),s.method,M);return}R=C(...s.params,P.token)}else{if(_!==void 0&&_.parameterStructures===p.ParameterStructures.byPosition){c(new p.ResponseError(p.ErrorCodes.InvalidParams,`Request ${s.method} defines parameters by position but received parameters by name`),s.method,M);return}R=C(s.params,P.token)}else $&&(R=$(s.method,s.params,P.token));let k=R;R?k.then?k.then(q=>{J.delete(b),a(q,s.method,M)},q=>{J.delete(b),q instanceof p.ResponseError?c(q,s.method,M):q&&I.string(q.message)?c(new p.ResponseError(p.ErrorCodes.InternalError,`Request ${s.method} failed with message: ${q.message}`),s.method,M):c(new p.ResponseError(p.ErrorCodes.InternalError,`Request ${s.method} failed unexpectedly without providing any details.`),s.method,M)}):(J.delete(b),a(R,s.method,M)):(J.delete(b),f(R,s.method,M))}catch(R){J.delete(b),R instanceof p.ResponseError?a(R,s.method,M):R&&I.string(R.message)?c(new p.ResponseError(p.ErrorCodes.InternalError,`Request ${s.method} failed with message: ${R.message}`),s.method,M):c(new p.ResponseError(p.ErrorCodes.InternalError,`Request ${s.method} failed unexpectedly without providing any details.`),s.method,M)}}else c(new p.ResponseError(p.ErrorCodes.MethodNotFound,`Unhandled method ${s.method}`),s.method,M)}function Zn(s){if(!he())if(s.id===null)s.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(s.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let a=s.id,c=ae.get(a);if(is(s,c),c!==void 0){ae.delete(a);try{if(s.error){let f=s.error;c.reject(new p.ResponseError(f.code,f.message,f.data))}else if(s.result!==void 0)c.resolve(s.result);else throw new Error("Should never happen.")}catch(f){f.message?i.error(`Response handler '${c.method}' failed with message: ${f.message}`):i.error(`Response handler '${c.method}' failed unexpectedly.`)}}}}function es(s){if(he())return;let a,c;if(s.method===Me.type.method){let f=s.params.id;Ae.delete(f),ct(s);return}else{let f=ie.get(s.method);f&&(c=f.handler,a=f.type)}if(c||H)try{if(ct(s),c)if(s.params===void 0)a!==void 0&&a.numberOfParams!==0&&a.parameterStructures!==p.ParameterStructures.byName&&i.error(`Notification ${s.method} defines ${a.numberOfParams} params but received none.`),c();else if(Array.isArray(s.params)){let f=s.params;s.method===Le.type.method&&f.length===2&&sr.is(f[0])?c({token:f[0],value:f[1]}):(a!==void 0&&(a.parameterStructures===p.ParameterStructures.byName&&i.error(`Notification ${s.method} defines parameters by name but received parameters by position`),a.numberOfParams!==s.params.length&&i.error(`Notification ${s.method} defines ${a.numberOfParams} params but received ${f.length} arguments`)),c(...f))}else a!==void 0&&a.parameterStructures===p.ParameterStructures.byPosition&&i.error(`Notification ${s.method} defines parameters by position but received parameters by name`),c(s.params);else H&&H(s.method,s.params)}catch(f){f.message?i.error(`Notification handler '${s.method}' failed with message: ${f.message}`):i.error(`Notification handler '${s.method}' failed unexpectedly.`)}else Pr.fire(s)}function ts(s){if(!s){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(s,null,4)}`);let a=s;if(I.string(a.id)||I.number(a.id)){let c=a.id,f=ae.get(c);f&&f.reject(new Error("The received response has neither a result nor an error property."))}}function Z(s){if(s!=null)switch(w){case y.Verbose:return JSON.stringify(s,null,4);case y.Compact:return JSON.stringify(s);default:return}}function rs(s){if(!(w===y.Off||!A))if(ce===U.Text){let a;(w===y.Verbose||w===y.Compact)&&s.params&&(a=`Params: ${Z(s.params)}

`),A.log(`Sending request '${s.method} - (${s.id})'.`,a)}else pe("send-request",s)}function ns(s){if(!(w===y.Off||!A))if(ce===U.Text){let a;(w===y.Verbose||w===y.Compact)&&(s.params?a=`Params: ${Z(s.params)}

`:a=`No parameters provided.

`),A.log(`Sending notification '${s.method}'.`,a)}else pe("send-notification",s)}function ke(s,a,c){if(!(w===y.Off||!A))if(ce===U.Text){let f;(w===y.Verbose||w===y.Compact)&&(s.error&&s.error.data?f=`Error data: ${Z(s.error.data)}

`:s.result?f=`Result: ${Z(s.result)}

`:s.error===void 0&&(f=`No result returned.

`)),A.log(`Sending response '${a} - (${s.id})'. Processing request took ${Date.now()-c}ms`,f)}else pe("send-response",s)}function ss(s){if(!(w===y.Off||!A))if(ce===U.Text){let a;(w===y.Verbose||w===y.Compact)&&s.params&&(a=`Params: ${Z(s.params)}

`),A.log(`Received request '${s.method} - (${s.id})'.`,a)}else pe("receive-request",s)}function ct(s){if(!(w===y.Off||!A||s.method===Be.type.method))if(ce===U.Text){let a;(w===y.Verbose||w===y.Compact)&&(s.params?a=`Params: ${Z(s.params)}

`:a=`No parameters provided.

`),A.log(`Received notification '${s.method}'.`,a)}else pe("receive-notification",s)}function is(s,a){if(!(w===y.Off||!A))if(ce===U.Text){let c;if((w===y.Verbose||w===y.Compact)&&(s.error&&s.error.data?c=`Error data: ${Z(s.error.data)}

`:s.result?c=`Result: ${Z(s.result)}

`:s.error===void 0&&(c=`No result returned.

`)),a){let f=s.error?` Request failed: ${s.error.message} (${s.error.code}).`:"";A.log(`Received response '${a.method} - (${s.id})' in ${Date.now()-a.timerStart}ms.${f}`,c)}else A.log(`Received response ${s.id} without active response promise.`,c)}else pe("receive-response",s)}function pe(s,a){if(!A||w===y.Off)return;let c={isLSPMessage:!0,type:s,message:a,timestamp:Date.now()};A.log(c)}function we(){if($r())throw new _e(Ce.Closed,"Connection is closed.");if(he())throw new _e(Ce.Disposed,"Connection is disposed.")}function os(){if(Mr())throw new _e(Ce.AlreadyListening,"Connection is already listening")}function as(){if(!Mr())throw new Error("Call listen() first.")}function Oe(s){return s===void 0?null:s}function jr(s){if(s!==null)return s}function Dr(s){return s!=null&&!Array.isArray(s)&&typeof s=="object"}function ut(s,a){switch(s){case p.ParameterStructures.auto:return Dr(a)?jr(a):[Oe(a)];case p.ParameterStructures.byName:if(!Dr(a))throw new Error("Received parameters by name but param is not an object literal.");return jr(a);case p.ParameterStructures.byPosition:return[Oe(a)];default:throw new Error(`Unknown parameter structure ${s.toString()}`)}}function qr(s,a){let c,f=s.numberOfParams;switch(f){case 0:c=void 0;break;case 1:c=ut(s.parameterStructures,a[0]);break;default:c=[];for(let O=0;O<a.length&&O<f;O++)c.push(Oe(a[O]));if(a.length<f)for(let O=a.length;O<f;O++)c.push(null);break}return c}let me={sendNotification:(s,...a)=>{we();let c,f;if(I.string(s)){c=s;let _=a[0],C=0,M=p.ParameterStructures.auto;p.ParameterStructures.is(_)&&(C=1,M=_);let b=a.length,P=b-C;switch(P){case 0:f=void 0;break;case 1:f=ut(M,a[C]);break;default:if(M===p.ParameterStructures.byName)throw new Error(`Received ${P} parameters for 'by Name' notification parameter structure.`);f=a.slice(C,b).map(R=>Oe(R));break}}else{let _=a;c=s.method,f=qr(s,_)}let O={jsonrpc:F,method:c,params:f};return ns(O),e.write(O).catch(_=>{throw i.error("Sending notification failed."),_})},onNotification:(s,a)=>{we();let c;return I.func(s)?H=s:a&&(I.string(s)?(c=s,ie.set(s,{type:void 0,handler:a})):(c=s.method,ie.set(s.method,{type:s,handler:a}))),{dispose:()=>{c!==void 0?ie.delete(c):H=void 0}}},onProgress:(s,a,c)=>{if(fe.has(a))throw new Error(`Progress handler for token ${a} already registered`);return fe.set(a,c),{dispose:()=>{fe.delete(a)}}},sendProgress:(s,a,c)=>me.sendNotification(Le.type,{token:a,value:c}),onUnhandledProgress:Ir.event,sendRequest:(s,...a)=>{we(),as();let c,f,O;if(I.string(s)){c=s;let b=a[0],P=a[a.length-1],R=0,k=p.ParameterStructures.auto;p.ParameterStructures.is(b)&&(R=1,k=b);let q=a.length;nr.CancellationToken.is(P)&&(q=q-1,O=P);let B=q-R;switch(B){case 0:f=void 0;break;case 1:f=ut(k,a[R]);break;default:if(k===p.ParameterStructures.byName)throw new Error(`Received ${B} parameters for 'by Name' request parameter structure.`);f=a.slice(R,q).map(cs=>Oe(cs));break}}else{let b=a;c=s.method,f=qr(s,b);let P=s.numberOfParams;O=nr.CancellationToken.is(b[P])?b[P]:void 0}let _=u++,C;O&&(C=O.onCancellationRequested(()=>{let b=Y.sender.sendCancellation(me,_);return b===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${_}`),Promise.resolve()):b.catch(()=>{i.log(`Sending cancellation messages for id ${_} failed`)})}));let M={jsonrpc:F,id:_,method:c,params:f};return rs(M),typeof Y.sender.enableCancellation=="function"&&Y.sender.enableCancellation(M),new Promise(async(b,P)=>{let R=B=>{b(B),Y.sender.cleanup(_),C?.dispose()},k=B=>{P(B),Y.sender.cleanup(_),C?.dispose()},q={method:c,timerStart:Date.now(),resolve:R,reject:k};try{await e.write(M),ae.set(_,q)}catch(B){throw i.error("Sending request failed."),q.reject(new p.ResponseError(p.ErrorCodes.MessageWriteError,B.message?B.message:"Unknown reason")),B}})},onRequest:(s,a)=>{we();let c=null;return or.is(s)?(c=void 0,$=s):I.string(s)?(c=null,a!==void 0&&(c=s,W.set(s,{handler:a,type:void 0}))):a!==void 0&&(c=s.method,W.set(s.method,{type:s,handler:a})),{dispose:()=>{c!==null&&(c!==void 0?W.delete(c):$=void 0)}}},hasPendingResponse:()=>ae.size>0,trace:async(s,a,c)=>{let f=!1,O=U.Text;c!==void 0&&(I.boolean(c)?f=c:(f=c.sendNotification||!1,O=c.traceFormat||U.Text)),w=s,ce=O,w===y.Off?A=void 0:A=a,f&&!$r()&&!he()&&await me.sendNotification(ar.type,{value:y.toString(s)})},onError:at.event,onClose:vr.event,onUnhandledNotification:Pr.event,onDispose:Lr.event,end:()=>{e.end()},dispose:()=>{if(he())return;K=X.Disposed,Lr.fire(void 0);let s=new p.ResponseError(p.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let a of ae.values())a.reject(s);ae=new Map,J=new Map,Ae=new Set,oe=new sn.LinkedMap,I.func(e.dispose)&&e.dispose(),I.func(r.dispose)&&r.dispose()},listen:()=>{we(),os(),K=X.Listening,r.listen(Kn)},inspect:()=>{(0,nn.default)().console.log("inspect")}};return me.onNotification(Be.type,s=>{if(w===y.Off||!A)return;let a=w===y.Verbose||w===y.Compact;A.log(s.message,a?s.verbose:void 0)}),me.onNotification(Le.type,s=>{let a=fe.get(s.token);a?a(s.value):Ir.fire(s)}),me}m.createMessageConnection=Ms});var Ye=N(o=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});o.ProgressType=o.ProgressToken=o.createMessageConnection=o.NullLogger=o.ConnectionOptions=o.ConnectionStrategy=o.AbstractMessageBuffer=o.WriteableStreamMessageWriter=o.AbstractMessageWriter=o.MessageWriter=o.ReadableStreamMessageReader=o.AbstractMessageReader=o.MessageReader=o.SharedArrayReceiverStrategy=o.SharedArraySenderStrategy=o.CancellationToken=o.CancellationTokenSource=o.Emitter=o.Event=o.Disposable=o.LRUCache=o.Touch=o.LinkedMap=o.ParameterStructures=o.NotificationType9=o.NotificationType8=o.NotificationType7=o.NotificationType6=o.NotificationType5=o.NotificationType4=o.NotificationType3=o.NotificationType2=o.NotificationType1=o.NotificationType0=o.NotificationType=o.ErrorCodes=o.ResponseError=o.RequestType9=o.RequestType8=o.RequestType7=o.RequestType6=o.RequestType5=o.RequestType4=o.RequestType3=o.RequestType2=o.RequestType1=o.RequestType0=o.RequestType=o.Message=o.RAL=void 0;o.MessageStrategy=o.CancellationStrategy=o.CancellationSenderStrategy=o.CancellationReceiverStrategy=o.ConnectionError=o.ConnectionErrors=o.LogTraceNotification=o.SetTraceNotification=o.TraceFormat=o.TraceValues=o.Trace=void 0;var T=kt();Object.defineProperty(o,"Message",{enumerable:!0,get:function(){return T.Message}});Object.defineProperty(o,"RequestType",{enumerable:!0,get:function(){return T.RequestType}});Object.defineProperty(o,"RequestType0",{enumerable:!0,get:function(){return T.RequestType0}});Object.defineProperty(o,"RequestType1",{enumerable:!0,get:function(){return T.RequestType1}});Object.defineProperty(o,"RequestType2",{enumerable:!0,get:function(){return T.RequestType2}});Object.defineProperty(o,"RequestType3",{enumerable:!0,get:function(){return T.RequestType3}});Object.defineProperty(o,"RequestType4",{enumerable:!0,get:function(){return T.RequestType4}});Object.defineProperty(o,"RequestType5",{enumerable:!0,get:function(){return T.RequestType5}});Object.defineProperty(o,"RequestType6",{enumerable:!0,get:function(){return T.RequestType6}});Object.defineProperty(o,"RequestType7",{enumerable:!0,get:function(){return T.RequestType7}});Object.defineProperty(o,"RequestType8",{enumerable:!0,get:function(){return T.RequestType8}});Object.defineProperty(o,"RequestType9",{enumerable:!0,get:function(){return T.RequestType9}});Object.defineProperty(o,"ResponseError",{enumerable:!0,get:function(){return T.ResponseError}});Object.defineProperty(o,"ErrorCodes",{enumerable:!0,get:function(){return T.ErrorCodes}});Object.defineProperty(o,"NotificationType",{enumerable:!0,get:function(){return T.NotificationType}});Object.defineProperty(o,"NotificationType0",{enumerable:!0,get:function(){return T.NotificationType0}});Object.defineProperty(o,"NotificationType1",{enumerable:!0,get:function(){return T.NotificationType1}});Object.defineProperty(o,"NotificationType2",{enumerable:!0,get:function(){return T.NotificationType2}});Object.defineProperty(o,"NotificationType3",{enumerable:!0,get:function(){return T.NotificationType3}});Object.defineProperty(o,"NotificationType4",{enumerable:!0,get:function(){return T.NotificationType4}});Object.defineProperty(o,"NotificationType5",{enumerable:!0,get:function(){return T.NotificationType5}});Object.defineProperty(o,"NotificationType6",{enumerable:!0,get:function(){return T.NotificationType6}});Object.defineProperty(o,"NotificationType7",{enumerable:!0,get:function(){return T.NotificationType7}});Object.defineProperty(o,"NotificationType8",{enumerable:!0,get:function(){return T.NotificationType8}});Object.defineProperty(o,"NotificationType9",{enumerable:!0,get:function(){return T.NotificationType9}});Object.defineProperty(o,"ParameterStructures",{enumerable:!0,get:function(){return T.ParameterStructures}});var lr=jt();Object.defineProperty(o,"LinkedMap",{enumerable:!0,get:function(){return lr.LinkedMap}});Object.defineProperty(o,"LRUCache",{enumerable:!0,get:function(){return lr.LRUCache}});Object.defineProperty(o,"Touch",{enumerable:!0,get:function(){return lr.Touch}});var $s=Br();Object.defineProperty(o,"Disposable",{enumerable:!0,get:function(){return $s.Disposable}});var un=be();Object.defineProperty(o,"Event",{enumerable:!0,get:function(){return un.Event}});Object.defineProperty(o,"Emitter",{enumerable:!0,get:function(){return un.Emitter}});var ln=Ge();Object.defineProperty(o,"CancellationTokenSource",{enumerable:!0,get:function(){return ln.CancellationTokenSource}});Object.defineProperty(o,"CancellationToken",{enumerable:!0,get:function(){return ln.CancellationToken}});var dn=Hr();Object.defineProperty(o,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return dn.SharedArraySenderStrategy}});Object.defineProperty(o,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return dn.SharedArrayReceiverStrategy}});var dr=Qr();Object.defineProperty(o,"MessageReader",{enumerable:!0,get:function(){return dr.MessageReader}});Object.defineProperty(o,"AbstractMessageReader",{enumerable:!0,get:function(){return dr.AbstractMessageReader}});Object.defineProperty(o,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return dr.ReadableStreamMessageReader}});var fr=tn();Object.defineProperty(o,"MessageWriter",{enumerable:!0,get:function(){return fr.MessageWriter}});Object.defineProperty(o,"AbstractMessageWriter",{enumerable:!0,get:function(){return fr.AbstractMessageWriter}});Object.defineProperty(o,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return fr.WriteableStreamMessageWriter}});var As=rn();Object.defineProperty(o,"AbstractMessageBuffer",{enumerable:!0,get:function(){return As.AbstractMessageBuffer}});var x=cn();Object.defineProperty(o,"ConnectionStrategy",{enumerable:!0,get:function(){return x.ConnectionStrategy}});Object.defineProperty(o,"ConnectionOptions",{enumerable:!0,get:function(){return x.ConnectionOptions}});Object.defineProperty(o,"NullLogger",{enumerable:!0,get:function(){return x.NullLogger}});Object.defineProperty(o,"createMessageConnection",{enumerable:!0,get:function(){return x.createMessageConnection}});Object.defineProperty(o,"ProgressToken",{enumerable:!0,get:function(){return x.ProgressToken}});Object.defineProperty(o,"ProgressType",{enumerable:!0,get:function(){return x.ProgressType}});Object.defineProperty(o,"Trace",{enumerable:!0,get:function(){return x.Trace}});Object.defineProperty(o,"TraceValues",{enumerable:!0,get:function(){return x.TraceValues}});Object.defineProperty(o,"TraceFormat",{enumerable:!0,get:function(){return x.TraceFormat}});Object.defineProperty(o,"SetTraceNotification",{enumerable:!0,get:function(){return x.SetTraceNotification}});Object.defineProperty(o,"LogTraceNotification",{enumerable:!0,get:function(){return x.LogTraceNotification}});Object.defineProperty(o,"ConnectionErrors",{enumerable:!0,get:function(){return x.ConnectionErrors}});Object.defineProperty(o,"ConnectionError",{enumerable:!0,get:function(){return x.ConnectionError}});Object.defineProperty(o,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return x.CancellationReceiverStrategy}});Object.defineProperty(o,"CancellationSenderStrategy",{enumerable:!0,get:function(){return x.CancellationSenderStrategy}});Object.defineProperty(o,"CancellationStrategy",{enumerable:!0,get:function(){return x.CancellationStrategy}});Object.defineProperty(o,"MessageStrategy",{enumerable:!0,get:function(){return x.MessageStrategy}});var ks=te();o.RAL=ks.default});var pn=N(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});var fn=require("util"),Q=Ye(),Ze=class r extends Q.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return r.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new fn.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}};Ze.emptyBuffer=Buffer.allocUnsafe(0);var hr=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Q.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Q.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Q.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),Q.Disposable.create(()=>this.stream.off("data",e))}},pr=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Q.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Q.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Q.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((n,i)=>{let u=S=>{S==null?n():i(S)};typeof e=="string"?this.stream.write(e,t,u):this.stream.write(e,u)})}end(){this.stream.end()}},hn=Object.freeze({messageBuffer:Object.freeze({create:r=>new Ze(r)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(r,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(r,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(r,e)=>{try{return r instanceof Buffer?Promise.resolve(JSON.parse(r.toString(e.charset))):Promise.resolve(JSON.parse(new fn.TextDecoder(e.charset).decode(r)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:r=>new hr(r),asWritableStream:r=>new pr(r)}),console,timer:Object.freeze({setTimeout(r,e,...t){let n=setTimeout(r,e,...t);return{dispose:()=>clearTimeout(n)}},setImmediate(r,...e){let t=setImmediate(r,...e);return{dispose:()=>clearImmediate(t)}},setInterval(r,e,...t){let n=setInterval(r,e,...t);return{dispose:()=>clearInterval(n)}}})});function mr(){return hn}(function(r){function e(){Q.RAL.install(hn)}r.install=e})(mr||(mr={}));gr.default=mr});var En=N(E=>{"use strict";var xs=E&&E.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),js=E&&E.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&xs(e,r,t)};Object.defineProperty(E,"__esModule",{value:!0});E.createMessageConnection=E.createServerSocketTransport=E.createClientSocketTransport=E.createServerPipeTransport=E.createClientPipeTransport=E.generateRandomPipeName=E.StreamMessageWriter=E.StreamMessageReader=E.SocketMessageWriter=E.SocketMessageReader=E.PortMessageWriter=E.PortMessageReader=E.IPCMessageWriter=E.IPCMessageReader=void 0;var Ne=pn();Ne.default.install();var mn=require("path"),Ds=require("os"),qs=require("crypto"),rt=require("net"),V=Ye();js(Ye(),E);var Er=class extends V.AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",n=>this.fireError(n)),t.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),V.Disposable.create(()=>this.process.off("message",e))}};E.IPCMessageReader=Er;var br=class extends V.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let t=this.process;t.on("error",n=>this.fireError(n)),t.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0}),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};E.IPCMessageWriter=br;var yr=class extends V.AbstractMessageReader{constructor(e){super(),this.onData=new V.Emitter,e.on("close",()=>this.fireClose),e.on("error",t=>this.fireError(t)),e.on("message",t=>{this.onData.fire(t)})}listen(e){return this.onData.event(e)}};E.PortMessageReader=yr;var Rr=class extends V.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.on("close",()=>this.fireClose()),e.on("error",t=>this.fireError(t))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};E.PortMessageWriter=Rr;var le=class extends V.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,Ne.default)().stream.asReadableStream(e),t)}};E.SocketMessageReader=le;var de=class extends V.WriteableStreamMessageWriter{constructor(e,t){super((0,Ne.default)().stream.asWritableStream(e),t),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};E.SocketMessageWriter=de;var et=class extends V.ReadableStreamMessageReader{constructor(e,t){super((0,Ne.default)().stream.asReadableStream(e),t)}};E.StreamMessageReader=et;var tt=class extends V.WriteableStreamMessageWriter{constructor(e,t){super((0,Ne.default)().stream.asWritableStream(e),t)}};E.StreamMessageWriter=tt;var gn=process.env.XDG_RUNTIME_DIR,Fs=new Map([["linux",107],["darwin",103]]);function Gs(){let r=(0,qs.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${r}-sock`;let e;gn?e=mn.join(gn,`vscode-ipc-${r}.sock`):e=mn.join(Ds.tmpdir(),`vscode-${r}.sock`);let t=Fs.get(process.platform);return t!==void 0&&e.length>t&&(0,Ne.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${t} characters.`),e}E.generateRandomPipeName=Gs;function Us(r,e="utf-8"){let t,n=new Promise((i,u)=>{t=i});return new Promise((i,u)=>{let S=(0,rt.createServer)(L=>{S.close(),t([new le(L,e),new de(L,e)])});S.on("error",u),S.listen(r,()=>{S.removeListener("error",u),i({onConnected:()=>n})})})}E.createClientPipeTransport=Us;function Vs(r,e="utf-8"){let t=(0,rt.createConnection)(r);return[new le(t,e),new de(t,e)]}E.createServerPipeTransport=Vs;function Xs(r,e="utf-8"){let t,n=new Promise((i,u)=>{t=i});return new Promise((i,u)=>{let S=(0,rt.createServer)(L=>{S.close(),t([new le(L,e),new de(L,e)])});S.on("error",u),S.listen(r,"127.0.0.1",()=>{S.removeListener("error",u),i({onConnected:()=>n})})})}E.createClientSocketTransport=Xs;function Ws(r,e="utf-8"){let t=(0,rt.createConnection)(r,"127.0.0.1");return[new le(t,e),new de(t,e)]}E.createServerSocketTransport=Ws;function Bs(r){let e=r;return e.read!==void 0&&e.addListener!==void 0}function zs(r){let e=r;return e.write!==void 0&&e.addListener!==void 0}function Hs(r,e,t,n){t||(t=V.NullLogger);let i=Bs(r)?new et(r):r,u=zs(e)?new tt(e):e;return V.ConnectionStrategy.is(n)&&(n={connectionStrategy:n}),(0,V.createMessageConnection)(i,u,t,n)}E.createMessageConnection=Hs});var yn=N((Fi,bn)=>{"use strict";bn.exports=En()});var Sr=N((Gi,Rn)=>{var Js=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};Rn.exports=Js});var _r=N((Ui,Sn)=>{var Qs="2.0.0",Ks=Number.MAX_SAFE_INTEGER||9007199254740991,Ys=16,Zs=250,ei=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Sn.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:Ys,MAX_SAFE_BUILD_LENGTH:Zs,MAX_SAFE_INTEGER:Ks,RELEASE_TYPES:ei,SEMVER_SPEC_VERSION:Qs,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Nn=N((z,_n)=>{var{MAX_SAFE_COMPONENT_LENGTH:Nr,MAX_SAFE_BUILD_LENGTH:ti,MAX_LENGTH:ri}=_r(),ni=Sr();z=_n.exports={};var si=z.re=[],ii=z.safeRe=[],l=z.src=[],oi=z.safeSrc=[],d=z.t={},ai=0,Tr="[a-zA-Z0-9-]",ci=[["\\s",1],["\\d",ri],[Tr,ti]],ui=r=>{for(let[e,t]of ci)r=r.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return r},g=(r,e,t)=>{let n=ui(e),i=ai++;ni(r,i,e),d[r]=i,l[i]=e,oi[i]=n,si[i]=new RegExp(e,t?"g":void 0),ii[i]=new RegExp(n,t?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*");g("NUMERICIDENTIFIERLOOSE","\\d+");g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Tr}*`);g("MAINVERSION",`(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})`);g("MAINVERSIONLOOSE",`(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})`);g("PRERELEASEIDENTIFIER",`(?:${l[d.NUMERICIDENTIFIER]}|${l[d.NONNUMERICIDENTIFIER]})`);g("PRERELEASEIDENTIFIERLOOSE",`(?:${l[d.NUMERICIDENTIFIERLOOSE]}|${l[d.NONNUMERICIDENTIFIER]})`);g("PRERELEASE",`(?:-(${l[d.PRERELEASEIDENTIFIER]}(?:\\.${l[d.PRERELEASEIDENTIFIER]})*))`);g("PRERELEASELOOSE",`(?:-?(${l[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[d.PRERELEASEIDENTIFIERLOOSE]})*))`);g("BUILDIDENTIFIER",`${Tr}+`);g("BUILD",`(?:\\+(${l[d.BUILDIDENTIFIER]}(?:\\.${l[d.BUILDIDENTIFIER]})*))`);g("FULLPLAIN",`v?${l[d.MAINVERSION]}${l[d.PRERELEASE]}?${l[d.BUILD]}?`);g("FULL",`^${l[d.FULLPLAIN]}$`);g("LOOSEPLAIN",`[v=\\s]*${l[d.MAINVERSIONLOOSE]}${l[d.PRERELEASELOOSE]}?${l[d.BUILD]}?`);g("LOOSE",`^${l[d.LOOSEPLAIN]}$`);g("GTLT","((?:<|>)?=?)");g("XRANGEIDENTIFIERLOOSE",`${l[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);g("XRANGEIDENTIFIER",`${l[d.NUMERICIDENTIFIER]}|x|X|\\*`);g("XRANGEPLAIN",`[v=\\s]*(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:${l[d.PRERELEASE]})?${l[d.BUILD]}?)?)?`);g("XRANGEPLAINLOOSE",`[v=\\s]*(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:${l[d.PRERELEASELOOSE]})?${l[d.BUILD]}?)?)?`);g("XRANGE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAIN]}$`);g("XRANGELOOSE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAINLOOSE]}$`);g("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Nr}})(?:\\.(\\d{1,${Nr}}))?(?:\\.(\\d{1,${Nr}}))?`);g("COERCE",`${l[d.COERCEPLAIN]}(?:$|[^\\d])`);g("COERCEFULL",l[d.COERCEPLAIN]+`(?:${l[d.PRERELEASE]})?(?:${l[d.BUILD]})?(?:$|[^\\d])`);g("COERCERTL",l[d.COERCE],!0);g("COERCERTLFULL",l[d.COERCEFULL],!0);g("LONETILDE","(?:~>?)");g("TILDETRIM",`(\\s*)${l[d.LONETILDE]}\\s+`,!0);z.tildeTrimReplace="$1~";g("TILDE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAIN]}$`);g("TILDELOOSE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAINLOOSE]}$`);g("LONECARET","(?:\\^)");g("CARETTRIM",`(\\s*)${l[d.LONECARET]}\\s+`,!0);z.caretTrimReplace="$1^";g("CARET",`^${l[d.LONECARET]}${l[d.XRANGEPLAIN]}$`);g("CARETLOOSE",`^${l[d.LONECARET]}${l[d.XRANGEPLAINLOOSE]}$`);g("COMPARATORLOOSE",`^${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]})$|^$`);g("COMPARATOR",`^${l[d.GTLT]}\\s*(${l[d.FULLPLAIN]})$|^$`);g("COMPARATORTRIM",`(\\s*)${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]}|${l[d.XRANGEPLAIN]})`,!0);z.comparatorTrimReplace="$1$2$3";g("HYPHENRANGE",`^\\s*(${l[d.XRANGEPLAIN]})\\s+-\\s+(${l[d.XRANGEPLAIN]})\\s*$`);g("HYPHENRANGELOOSE",`^\\s*(${l[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[d.XRANGEPLAINLOOSE]})\\s*$`);g("STAR","(<|>)?=?\\s*\\*");g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var wn=N((Vi,Tn)=>{var li=Object.freeze({loose:!0}),di=Object.freeze({}),fi=r=>r?typeof r!="object"?li:r:di;Tn.exports=fi});var In=N((Xi,Pn)=>{var On=/^[0-9]+$/,vn=(r,e)=>{let t=On.test(r),n=On.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},hi=(r,e)=>vn(e,r);Pn.exports={compareIdentifiers:vn,rcompareIdentifiers:hi}});var An=N((Wi,$n)=>{var nt=Sr(),{MAX_LENGTH:Ln,MAX_SAFE_INTEGER:st}=_r(),{safeRe:Cn,safeSrc:Mn,t:it}=Nn(),pi=wn(),{compareIdentifiers:Te}=In(),wr=class r{constructor(e,t){if(t=pi(t),e instanceof r){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Ln)throw new TypeError(`version is longer than ${Ln} characters`);nt("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?Cn[it.LOOSE]:Cn[it.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>st||this.major<0)throw new TypeError("Invalid major version");if(this.minor>st||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>st||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let u=+i;if(u>=0&&u<st)return u}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(nt("SemVer.compare",this.version,this.options,e),!(e instanceof r)){if(typeof e=="string"&&e===this.version)return 0;e=new r(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof r||(e=new r(e,this.options)),Te(this.major,e.major)||Te(this.minor,e.minor)||Te(this.patch,e.patch)}comparePre(e){if(e instanceof r||(e=new r(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],i=e.prerelease[t];if(nt("prerelease compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Te(n,i)}while(++t)}compareBuild(e){e instanceof r||(e=new r(e,this.options));let t=0;do{let n=this.build[t],i=e.build[t];if(nt("build compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Te(n,i)}while(++t)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(t){let i=new RegExp(`^${this.options.loose?Mn[it.PRERELEASELOOSE]:Mn[it.PRERELEASE]}$`),u=`-${t}`.match(i);if(!u||u[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[i];else{let u=this.prerelease.length;for(;--u>=0;)typeof this.prerelease[u]=="number"&&(this.prerelease[u]++,u=-2);if(u===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let u=[t,i];n===!1&&(u=[t]),Te(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=u):this.prerelease=u}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};$n.exports=wr});var Or=N((Bi,xn)=>{var kn=An(),mi=(r,e,t)=>new kn(r,t).compare(new kn(e,t));xn.exports=mi});var Dn=N((zi,jn)=>{var gi=Or(),Ei=(r,e,t)=>gi(r,e,t)>=0;jn.exports=Ei});var Fn=N((Hi,qn)=>{var bi=Or(),yi=(r,e,t)=>bi(r,e,t)<=0;qn.exports=yi});var se=lt(yn());var Ri=lt(Dn()),Gn=lt(Fn());function $e(r,e){return r.startsWith("0.0.0-insiders")?!1:(0,Gn.default)(r,e)}async function Si(r){let e=await import(r);return!e.scanDir&&!e.Scanner?null:e}async function Un(r){let e=await Si(r.oxidePath);if(!e)return null;if($e(r.oxideVersion,"4.0.0-alpha.18")){let t=e.scanDir?.({base:r.basePath,globs:!0});return{files:t.files,globs:t.globs.map(n=>({base:n.base,pattern:n.glob}))}}else if($e(r.oxideVersion,"4.0.0-alpha.19")){let t=e.scanDir({base:r.basePath,sources:r.sources.map(n=>({base:n.base,pattern:n.pattern}))});return{files:t.files,globs:t.globs.map(n=>({base:n.base,pattern:n.pattern}))}}else if($e(r.oxideVersion,"4.0.0-alpha.30")){let t=new e.Scanner({detectSources:{base:r.basePath},sources:r.sources.map(n=>({base:n.base,pattern:n.pattern}))});return{files:t.files,globs:t.globs.map(n=>({base:n.base,pattern:n.pattern}))}}else if($e(r.oxideVersion,"4.0.9999")){let t=new e.Scanner({sources:[{base:r.basePath,pattern:"**/*"},...r.sources.map(n=>({base:n.base,pattern:n.pattern}))]});return{files:t.files,globs:t.globs.map(n=>({base:n.base,pattern:n.pattern}))}}else{let t=new e.Scanner({sources:[{base:r.basePath,pattern:"**/*",negated:!1},...r.sources.map(n=>({base:n.base,pattern:n.pattern,negated:n.negated}))]});return{files:t.files,globs:t.globs.map(n=>({base:n.base,pattern:n.pattern}))}}}var Vn=se.createMessageConnection(new se.IPCMessageReader(process),new se.IPCMessageWriter(process)),_i=new se.RequestType("scan");Vn.onRequest(_i,r=>Un(r));Vn.listen();
